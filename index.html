<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galer√≠a - Home</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">üìö Mi Galer√≠a</a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link active">Home</a></li>
                <li><a href="admin.html" class="nav-link" id="createLink">Create</a></li>
                <li><a href="login.html" class="nav-link" id="authLink">Login</a></li>
            </ul>
        </div>
    </nav>

    <div class="gallery-header">
        <h1>üìñ Mi Galer√≠a Personal</h1>
    </div>
    
    <!-- Contenedor de libro √∫nico -->
    <div class="gallery-container" id="galleryContainer">
        <div class="book" id="currentBook">
            <!-- Aqu√≠ se cargar√° cada p√°gina -->
        </div>
        
        <!-- Controles de navegaci√≥n -->
        <div class="book-controls">
            <button id="prevBtn" class="book-btn">‚Üê Anterior</button>
            <span id="pageIndicator" class="page-indicator">1 / 1</span>
            <button id="nextBtn" class="book-btn">Siguiente ‚Üí</button>
        </div>
    </div>
    
    <div class="empty-state" id="emptyState" style="display: none;">
        <h2>La galer√≠a est√° vac√≠a</h2>
        <p>No hay contenido para mostrar todav√≠a</p>
    </div>
    
    <script src="js/app.js"></script>
    <script>
        let currentPage = 0;
        let galleryData = [];
        
        // Verificar autenticaci√≥n
        function checkAuth() {
            const currentUser = localStorage.getItem('currentUser');
            const authLink = document.getElementById('authLink');
            
            if (currentUser) {
                const user = JSON.parse(currentUser);
                authLink.textContent = 'Logout';
                authLink.href = '#';
                authLink.onclick = function(e) {
                    e.preventDefault();
                    localStorage.removeItem('currentUser');
                    window.location.reload();
                };
            } else {
                authLink.textContent = 'Login';
                authLink.href = 'login.html';
            }
        }
        
        // Renderizar p√°gina espec√≠fica
        function renderPage(index) {
            if (galleryData.length === 0) return;
            
            const item = galleryData[index];
            const bookContainer = document.getElementById('currentBook');
            
            bookContainer.innerHTML = `
                <div class="cover">
                    <div class="pages">
                        <div class="page page-left">
                            <img src="${item.image}" alt="${item.title}">
                        </div>
                        <div class="line"></div>
                        <div class="page page-right">
                            <h2>${item.title}</h2>
                            <p>${item.description}</p>
                            <div class="date">${new Date(item.date).toLocaleDateString('es-ES', {
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric'
                            })}</div>
                        </div>
                    </div>
                </div>
            `;
            
            // Actualizar indicador de p√°gina
            document.getElementById('pageIndicator').textContent = 
                `${index + 1} / ${galleryData.length}`;
            
            // Deshabilitar botones seg√∫n p√°gina
            document.getElementById('prevBtn').disabled = (index === 0);
            document.getElementById('nextBtn').disabled = (index === galleryData.length - 1);
        }
        
        // Navegaci√≥n
        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentPage > 0) {
                currentPage--;
                renderPage(currentPage);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });
        
        document.getElementById('nextBtn').addEventListener('click', () => {
            if (currentPage < galleryData.length - 1) {
                currentPage++;
                renderPage(currentPage);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });
        
        // Navegaci√≥n con teclado
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                document.getElementById('prevBtn').click();
            } else if (e.key === 'ArrowRight') {
                document.getElementById('nextBtn').click();
            }
        });
        
        // Renderizar galer√≠a
        async function renderGallery() {
            try {
                galleryData = await getGallery();
                const container = document.getElementById('galleryContainer');
                const emptyState = document.getElementById('emptyState');
                
                if (!Array.isArray(galleryData) || galleryData.length === 0) {
                    container.style.display = 'none';
                    emptyState.style.display = 'flex';
                    return;
                }
                
                container.style.display = 'flex';
                emptyState.style.display = 'none';
                
                // Mostrar primera p√°gina
                currentPage = 0;
                renderPage(currentPage);
            } catch (error) {
                console.error('Error renderizando galer√≠a:', error);
                document.getElementById('emptyState').style.display = 'flex';
            }
        }
        
        // Inicializar
        async function init() {
            checkAuth();
            await renderGallery();
        }
        
        init();
    </script>
</body>
</html>
